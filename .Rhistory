x <-rand$gametes[[1]]
x
spec <-sfs(x)
length(seg.sites(acp29))
dat.rnt <-entrez_search(db="popset",term="322367799")
dat.raw <-entrez_fetch("popset",id=dat.rnt$ids,rettype="fasta")
write(dat.raw,file="../Data/dog.fasta")
dog.dat <-read.FASTA("../Data/dog.fasta")
dog.dat
nms <- names(dog.dat)
nms
nms<- sapply(nms, function(x) word(x,8,9))
names(dog.dat) <- nms
dog.dat
dat.aln <-muscle(dog.dat)
image.DNAbin(dat.aln,cex.lab=.5)
dat.aln.sub <-dat.aln[,1:600]
image.DNAbin(dat.aln.sub,cex.lab=.5)
dat.hap <-haplotype(dat.aln.sub)
dat.hap
dat.dist <-dist.dna(dat.aln.sub)
dat.dist
plot(nj(dat.dist),type="phylo",cex=.8)
net <-haploNet(dat.hap)
fq <-attr(net,"freq")
plot(net,size=fq,threshold=0,cex=.5)
sample.no <-attr(dat.hap,"index")
breed.by.haplo <-sapply(sample.no, function(x) rownames(dat.aln.sub)[x])
sorted <-sapply(breed.by.haplo,paste,collapse=" ")
haplo <-as.roman(1:12)
kable(data.frame(Haplotype=as.character(haplo),Breed=sorted))
library(kable)
library(knitr)
kable(data.frame(Haplotype=as.character(haplo),Breed=sorted))
library(geomedb)
?geomedb
library(knitr)
library(rentrez)
library(pegas)
linckia<-queryFasta(marker="CO1",query="+genus:Linckia +species:laevigata")
linckia
str(linckia)
library(stringr)
?stringr
names(linckia)
dog.dat <-read.FASTA("../Data/dog.fasta")
names(dog.dat)
names(linckia)
str(linckia)
dimnames(linckia)
dimnames(linckia)[[1]]
rownames(dog.dat)
rownames(linckia)
linckia_aln<-muscle(linckia)
str_extract(string=rownames(linckia),pattern="locality=[A-Za-z /]+")
str_extract(string=rownames(linckia),pattern="locality=[A-Za-z]+")
str_extract(string=rownames(linckia),pattern="locality = \w+")
str_extract(string=rownames(linckia),pattern="locality = \\w+")
str_extract(string=rownames(linckia),pattern="locality = [.+]")
str_extract(string=rownames(linckia),pattern="locality = [.+\]")
tr_extract(string=rownames(linckia),pattern="locality = [.+\\]")
str_extract(string=rownames(linckia),pattern="locality = [.+\\]")
str_extract(string=rownames(linckia),pattern="locality = \\[.+\\]")
str_extract(string=rownames(linckia),pattern="locality = \\[.+\\]")
str_extract(string=rownames(linckia),pattern="locality = [.+]")
str_extract(string=rownames(linckia),pattern="locality = [.+\\]")
str_extract(string=rownames(linckia),pattern="locality = \\[.+\\]")
str_extract(string=rownames(linckia),pattern="\\[locality = .+\\]")
str_extract(string=rownames(linckia),pattern="\\[locality = .+?\\]")
linkia_aln2<-linckia_aln
rownames(linckia_aln)<-str_extract(string=rownames(linckia),pattern="\\[locality = .+?\\]")
rownames(linckia_aln)
str_replace(string=rownames(linckia),pattern="\\[locality = (.+?)\\]",replacement="\1")
str_replace(string=rownames(linckia_aln),pattern="\\[locality = (.+?)\\]",replacement="\1")
str_replace(string=rownames(linckia_aln),pattern="\\[locality = (.+?)\\]",replacement="\\1")
rownames(linckia_aln)<-str_replace(string=rownames(linckia_aln),pattern="\\[locality = (.+?)\\]",replacement="\\1")''
rownames(linckia_aln)<-str_replace(string=rownames(linckia_aln),pattern="\\[locality = (.+?)\\]",replacement="\\1")
linckia_aln
image.DNAbin(linckia_aln,cex.lab=.5)
image.DNAbin(linckia)
print(linckia)
str(linckia)
linckia[" ark:/21547/pD2LOM_SK11 [marker = CO1] [materialSampleID = LOM_SK11] [locality = Sekotong] [genus = Linckia] [species = laevigata]"]
linckia[1:5]
linckia[1:5,1:5]
as.matrix(linckia)
View(linckia)
write.dna(linckia,"test.fasta",format = "fasta")
write.dna(linckia_aln,"test2.fasta",format = "fasta")
kasmira<-queryFasta(marker="CO1",query="+genus:Lutjanus +species:kasmira")
image.DNAbin(kasmira)
write.dna(kasmira,"test3.fasta",format = "fasta")
length(kasmira)
length(rownames(kasmira))
kasmira<-queryFasta(marker="CYB",query="+genus:Lutjanus +species:kasmira")
length(rownames(kasmira))
write.dna(kasmira,"test4.fasta",format = "fasta")
pnod<-read.FASTA("../Data/pnodosus.fasta")
setwd("./lessons/Rmd")
pnod<-read.FASTA("../Data/pnodosus.fasta")
pnod_aln<-muscle(pnod)
rownames(pnod_aln)<-str_extract(string=rownames(pnod_aln),pattern="\\[locality = .+?\\]")
rownames(pnod_aln)<-str_replace(string=rownames(pnod_aln),pattern="\\[locality = (.+?)\\]",replacement="\\1")
rownames(pnod_aln)
str_replace(string=rownames(pnod_aln),pattern="\\"",replacement="")
str_replace(string=rownames(pnod_aln),pattern="\\",replacement="")
str_replace(string=rownames(pnod_aln),pattern="\\\",replacement="")
)
)
``
str_replace(string=rownames(pnod_aln),pattern="\\\"",replacement="")
str_replace_all(string=rownames(pnod_aln),pattern="\\\"",replacement="")
rownames(pnod_aln)<-str_replace_all(string=rownames(pnod_aln),pattern="\\\"",replacement="")
e <- dist.dna(pnod_aln)
h <- pegas::haplotype(pnod_aln)
h <- sort(h, what = "label")
net <- pegas::haploNet(h)
i<-stack(setNames(attr(h, "index"), rownames(h)))
ind.hap<- table(hap=i$ind, pop=pop)
plot(net, size=attr(net, "freq"), scale.ratio=0.2, pie=ind.hap,legend=F, labels=F)
legend("topleft", colnames(ind.hap), col=rainbow(ncol(ind.hap)), pch=19, ncol=2)
image.DNAbin()
image.DNAbin(pnod_aln)
pnod_aln_trim<-pnod_aln[,100:800]
image.DNAbin(pnod_aln_trim)
d <- dist.dna(pnod_aln_trim)
h <- pegas::haplotype(pnod_aln_trim)
h <- sort(h, what = "label")
net <- pegas::haploNet(h)
i<-stack(setNames(attr(h, "index"), rownames(h)))
ind.hap<- table(hap=i$ind, pop=pop)
plot(net, size=attr(net, "freq"), scale.ratio=0.2, pie=ind.hap,legend=F, labels=F)
legend("topleft", colnames(ind.hap), col=rainbow(ncol(ind.hap)), pch=19, ncol=2)
i<-stack(setNames(attr(h, "index"), rownames(h)))
i
pop
d <- dist.dna(pnod_aln_trim)
h <- pegas::haplotype(pnod_aln_trim)
h <- sort(h, what = "label")
net <- pegas::haploNet(h)
i<-stack(setNames(attr(h, "index"), rownames(h)))
ind.hap<- table(hap=i$ind, pop=pop)
plot(net, size=attr(net, "freq"), scale.ratio=0.2, pie=ind.hap,legend=F, labels=F)
legend("topleft", colnames(ind.hap), col=rainbow(ncol(ind.hap)), pch=19, ncol=2)
length(i$ind)
length(pop)
pop<-rownames(pnod_aln_trim)
pop
d <- dist.dna(pnod_aln_trim)
h <- pegas::haplotype(pnod_aln_trim)
h <- sort(h, what = "label")
net <- pegas::haploNet(h)
i<-stack(setNames(attr(h, "index"), rownames(h)))
ind.hap<- table(hap=i$ind, pop=pop)
plot(net, size=attr(net, "freq"), scale.ratio=0.2, pie=ind.hap,legend=F, labels=F)
legend("topleft", colnames(ind.hap), col=rainbow(ncol(ind.hap)), pch=19, ncol=2)
plot(net, size=attr(net, "freq"), scale.ratio=0.2, pie=ind.hap,legend=F, labels=F)
plot(net, size=attr(net, "freq"), scale.ratio=0.8, pie=ind.hap,legend=F, labels=F)
plot(net, size=attr(net, "freq"), scale.ratio=2, pie=ind.hap,legend=F, labels=F)
plot(net, size=attr(net, "freq"), scale.ratio=10, pie=ind.hap,legend=F, labels=F)
plot(net, size=attr(net, "freq"), scale.ratio=100, pie=ind.hap,legend=F, labels=F)
plot(net, size=attr(net, "freq"), scale.ratio=100, pie=ind.hap,legend=F, labels=F)
plot(net, size=attr(net, "freq"), scale.ratio=100, pie=ind.hap,legend=F, labels=F)
plot(net, size=attr(net, "freq"), scale.ratio=20, pie=ind.hap,legend=F, labels=F)
?plot.haploNet
plot(net, d=d,size=attr(net, "freq"), scale.ratio=20, pie=ind.hap,legend=F, labels=F)
ind.hap
?stack
i
plot(net,size=attr(net, "freq"), scale.ratio=20, pie=ind.hap,legend=F, labels=F)
library(strataG)
exptdHet
swfscMisc::diversity()
swfscMisc::diversity(
swfscMisc::diversity
dat.aln <-muscle(dog.dat)
image.DNAbin(dat.aln,cex.lab=.5)
dat.aln.sub <-dat.aln[,1:600]
image.DNAbin(dat.aln.sub,cex.lab=.5)
dat.hap <-haplotype(dat.aln.sub)
dat.hap
hap.diversity<-function (x){
#adapted from diversity() in StrataG
if (!(is.vector(x) | is.factor(x)))
stop("'x' must be a character or numeric vector, or a factor")
x <- na.omit(x)
n <- length(x)
x.freq <- prop.table(table(x))
out<-(1- sum(x.freq^2))/(n-1)
}
str(data.hap)
str(dat.hap)
summary(dat.hap)
rownames(dat.hap)
attr(dat.hap,"index")
dat.hap
str(dat.hap)
length(attr(dat.hap,"index"))
sapply(attr(dat.hap,"index")),length)
?sapply
sapply(attr(dat.hap,"index")),fun=length)
attr(dat.hap,"index")
lapply(attr(dat.hap,"index")),fun=length)
lapply(attr(dat.hap,"index"),fun=length)
lapply(attr(dat.hap,"index"),FUN = =length)
lapply(attr(dat.hap,"index"),FUN =length)
dat.hap
unlist(lapply(attr(dat.hap,"index"),FUN =length))
dat.hap <-haplotype(acp.mat)
acp29 <-read.FASTA("../Data/acp29.fasta")
acp29
names(acp29) <-c(1:17)
acp.mat <-muscle(acp29)
acp.sites <-seg.sites(acp29)
acp.sites
acp.nss <-length(acp.sites)
acp.nss
dat.hap <-haplotype(acp.mat)
dat.hap
acp.mat
hap.diversity<-function (x){
#adapted from diversity() in StrataG
if (!(is.vector(x) | is.factor(x)))
stop("'x' must be a character or numeric vector, or a factor")
x <- na.omit(x)
n <- length(x)
x.freq <- prop.table(table(x))
out<- (n/n-1)*(1- sum(x.freq^2))
}
hap.diversity(unlist(lapply(attr(dat.hap,"index"),FUN =length)))
acp.h<-hap.diversity(unlist(lapply(attr(dat.hap,"index"),FUN =length)))
acp.h
unlist(lapply(attr(acp.hap,"index"),FUN =length))
acp.hap <-haplotype(acp.mat)
acp.hap
acp.hap <-haplotype(acp.mat)
unlist(lapply(attr(acp.hap,"index"),FUN =length))
counts<-unlist(lapply(attr(acp.hap,"index"),FUN =length))
counts
hap.diversity(counts)
hap.diversity<-function (x){
#adapted from diversity() in StrataG
if (!(is.vector(x) | is.factor(x)))
stop("'x' must be a character or numeric vector, or a factor")
x <- na.omit(x)
n <- length(x)
x.freq <- prop.table(table(x))
out<- (n/n-1)*(1- sum(x.freq^2))
return(out)
}
hap.diversity(counts)
x<-counts
x <- na.omit(x)
xx
x
n <- length(x)
n
x.freq <- prop.table(table(x))
x.freq
acp.hap
str(acp.hap)
i
hap.diversity(i)
i$ind
hap.diversity(i$ind)
x
table(x)
table(i$ind)
prop.table(table(i$ind))
length(i$ind)
x.freq <- prop.table(table(i$ind))
x.freq
out<- (n/n-1)*(1- sum(x.freq^2))
out
x.freq^2
sum(x.freq^2)
1-sum(x.freq^2)
?strataG
g<-sequence2gtypes(acp.mat)
g
(n/n-1)
n<-length(i$ind)
n
(n/n-1)
hap.diversity<-function (x){
#adapted from diversity() in StrataG
if (!(is.vector(x) | is.factor(x)))
stop("'x' must be a character or numeric vector, or a factor")
x <- na.omit(x)
n <- length(x)
x.freq <- prop.table(table(x))
out<- (n/(n-1))*(1- sum(x.freq^2))
return(out)
}
hap.diversity(i$ind)
hap.diversity(x)
acp.gtype<-sequence2gtypes(acp.map)
acp.gtype<-sequence2gtypes(acp.mat)
acp.gtype
exptdHet(acp.mat)
?exptdHet
exptdHet(acp.gtype)
summary(acp.gtype)
str(acp.gtype)
g<-sequence2gtypes(pnod_aln_trim)
g
pnod_aln_trm
pnod_aln_trim
g<-sequence2gtypes(pnod_aln_trim)
g
pnod_aln_trim
str(g)
names(acp.gtype)
names(acp.mat)
acp.map
acp.mat
names(acp29)
acp.mat <-muscle(acp29)
names(acp29)
names(acp.mat)
sequence2gtypes(pnod_aln)
names(pnod_aln)
pnod_aln
labels(pnod_aln)
sequence2gtypes(pnod_aln,strata=labels(pnod_aln))
sequence2gtypes(pnod_aln,strata=labels(pnod_aln_trim))
pnod_aln_trim
g<-sequence2gtypes(pnod_aln_trim,strata=labels(pnod_aln_trim))
g
pnod_aln_trim
str(pnod_aln_trim)
pnod_aln_trim[22,]
pnod_aln_trim[23,]
pnod_aln_trim[23,1]
pnod_aln_trim[24,]
data(dolph.strata)
data(dolph.seqs)
strata <- dolph.strata$fine
strata
data.aln.sub
image.DNAbin(dat.aln.sub,cex.lab=.5)
dat.aln.sub
sequence2gtypes(data.aln.sub)
sequence2gtypes(dat.aln.sub)
exptdHet(acp.gtype)
pnod<-read.FASTA("../Data/pnodosus.fasta")
pnod_aln_trim
?read.FASTA
pnod<-read.FASTA("../Data/pnodosus.fasta",as.matrix=F)
pnod<-read.dna("../Data/pnodosus.fasta",format="fasta",as.matrix=F)
pnod_aln<-muscle(pnod)
rownames(pnod_aln)<-str_extract(string=rownames(pnod_aln),pattern="\\[locality = .+?\\]")
rownames(pnod_aln)<-str_replace(string=rownames(pnod_aln),pattern="\\[locality = (.+?)\\]",replacement="\\1")
#ignore this final line - this is a unique problem to this species
rownames(pnod_aln)<-str_replace_all(string=rownames(pnod_aln),pattern="\\\"",replacement="")
image.DNAbin(pnod_aln)
pnod_aln_trim<-pnod_aln[,100:800]
image.DNAbin(pnod_aln_trim)
g<-sequence2gtypes(pnod_aln_trim)
g
pnod_aln_trim
pnod
g<-sequence2gtypes(pnod)
g
g<-sequence2gtypes(pnod,strata=labels(pnod))
g
pnod_aln
?muscle
p<=as.DNAbin.list(pnod_aln_trim)
p<-as.DNAbin.list(pnod_aln_trim)
pnod_aln_trim
?as.DNAbin
p<-as.list(pnod_aln_trim)
p
g<-sequence2gtypes(pnod_aln_trim,strata=labels(pnod_aln_trim))
g
g<-sequence2gtypes(p,strata=labels(p))
g
p
g<-sequence2gtypes(p,strata=labels(p))
g<-sequence2gtypes(p
)
g
g<-sequence2gtypes(pnod)
g
str(g)
g<-sequence2gtypes(pnod, strata=labels(p))
g
g@strata
pnod_aln<-muscle(pnod)
pnod
pnod_aln_l<-as.list(pnod_aln)
names(pnod_aln)<-str_extract(string=names(pnod_aln),pattern="\\[locality = .+?\\]")
names(pnod_aln)<-str_replace(string=names(pnod_aln),pattern="\\[locality = (.+?)\\]",replacement="\\1")
names(pnod_aln)<-str_replace_all(string=names(pnod_aln),pattern="\\\"",replacement="")
image.DNAbin(pnod_aln)
pnod_aln_trim<-pnod_aln[,100:800]
image.DNAbin(pnod_aln_l)
names(pnod_aln_l)<-str_extract(string=names(pnod_aln_l),pattern="\\[locality = .+?\\]")
names(pnod_aln_l)<-str_replace_all(string=names(pnod_aln_l),pattern="\\\"",replacement="")
names(pnod_aln_l)<-str_replace_all(string=names(pnod_aln_l),pattern="\\\"",replacement="")
pnod_aln_trim<-pnod_aln_l[,100:800]
image.DNAbin(pnod_aln_trim)
image.DNAbin(pnod_aln_l)
pnod_aln_l
rownames(pnod_aln_l)<-str_replace(string=rownames(pnod_aln_l),pattern="\\[locality = (.+?)\\]",replacement="\\1")
names(pnod_aln_l)<-str_replace(string=names(pnod_aln_l),pattern="\\[locality = (.+?)\\]",replacement="\\1")
pnod_aln_l
sequence2gtypes(pnod_aln_l)
pnod<-read.dna("../Data/pnodosus.fasta",format="fasta",as.matrix=F)
names(pnod)<-str_extract(string=names(pnod),pattern="\\[locality = .+?\\]")
names(pnod)<-str_replace(string=names(pnod),pattern="\\[locality = (.+?)\\]",replacement="\\1")
names(pnod)<-str_replace_all(string=names(pnod),pattern="\\\"",replacement="")
pnod_trim<-pnod[,100:800]
as.matrix(pnod)
sequence2gtypes(pnod)
pnod<-read.dna("../Data/pnodosus.fasta",format="fasta",as.matrix=F)
sequence2gtypes(pnod)
names(pnod)<-str_extract(string=names(pnod),pattern="\\[locality = .+?\\]")
sequence2gtypes(pnod)
pnod<-read.dna("../Data/pnodosus.fasta",format="fasta",as.matrix=F)
pnod1<-pnod
names(pnod)<-str_extract(string=names(pnod),pattern="\\[locality = .+?\\]")
str(pnod)
str(pnod1)
pnod2<-as.matrix(pnod1)
sequence2gtypes(pnod2)
strata(pnod2)
pnod3<-sequence2gtypes(pnod2)
pnod3
pnod3
str(pnod3)
names(pnod3)
pnod3@strata
rownames(pnod_aln_trim)
rownames(pnod_aln)<-str_extract(string=rownames(pnod_aln),pattern="\\[locality = .+?\\]")
rownames(pnod_aln)<-str_replace(string=rownames(pnod_aln),pattern="\\[locality = (.+?)\\]",replacement="\\1")
#ignore this final line - this is a unique problem to this species
rownames(pnod_aln)<-str_replace_all(string=rownames(pnod_aln),pattern="\\\"",replacement="")
image.DNAbin(pnod_aln)
rownames(pnod_aln_trim)
rownames(pnod_aln)
pnod3@strata<-rownames(pnod_aln)
pnod3@strata<-factor(rownames(pnod_aln))
pnod3
pnod3
pnod3<-sequence2gtypes(pnod2,strata=rownames(pnod_aln))
pnod3
?nucleotideDiversity
?nuc.div
pairwise_Gst_Nei
?pairwise_Gst_Nei
image.DNAbin(pnod_aln_trim)
library(geomedb)
library(stringr)
#linckia<-queryFasta(marker="CO1",query="+genus:Linckia +species:laevigata")
#linckia
#write.dna(linckia,"test.fasta",format = "fasta")
pnod<-read.dna("../Data/pnodosus.fasta",format="fasta",as.matrix=F)
pnod_aln<-muscle(pnod)
library(geomedb)
library(stringr)
#linckia<-queryFasta(marker="CO1",query="+genus:Linckia +species:laevigata")
#linckia
#write.dna(linckia,"test.fasta",format = "fasta")
pnod<-read.dna("../Data/pnodosus.fasta",format="fasta",as.matrix=F)
pnod_aln<-muscle(pnod)
rownames(pnod_aln)<-str_extract(string=rownames(pnod_aln),pattern="\\[locality = .+?\\]")
rownames(pnod_aln)<-str_replace(string=rownames(pnod_aln),pattern="\\[locality = (.+?)\\]",replacement="\\1")
#ignore this final line - this is a unique problem to this species
rownames(pnod_aln)<-str_replace_all(string=rownames(pnod_aln),pattern="\\\"",replacement="")
image.DNAbin(pnod_aln)
pnod_aln_trim<-pnod_aln[,100:800]
image.DNAbin(pnod_aln_trim)
write.fasta(pnod_aln_trim,"../Data/pnodosus_aln_trim.fasta")
pnod2<-read.fasta("../Data/pnododus_aln_trim.fasta")
pnod2<-read.fasta("../Data/pnodosus_aln_trim.fasta")
pnod2
names(pnod2)
pnod3<-sequence2gtypes(pnod2)
pnod
pnod3
pnod2
?strataG
t<-read.FASTA("../Data/pnodosus_aln_trim.fasta")
t
t2<-sequence2gtypes(t)
t2
?write.fasta
hap.diversity(unlist(lapply(attr(acp.hap,"index"),FUN =length)))
unlist(lapply(attr(acp.hap,"index"),FUN =length)
)
pegas::haplotype(pnod_aln_trim)
h
unlist(lapply(attr(h,"index"),FUN =length)
)
hap.diversity(unlist(lapply(attr(h,"index"),FUN =length)))
g<-unlist(lapply(attr(acp.hap,"index"),FUN =length))
g
prop.table(table(g))
?labelHaplotypes
labelHaplotypes(acp.mat)
labelHaplotypes(acp.mat)$haps
x<-labelHaplotypes(acp.mat)$haps
x
str(x)
hap.diversity(x)
acp.h<-hap.diversity(acp.hap.labs))
acp.h<-hap.diversity(acp.hap.labs)
acp.hap.labs<-labelHaplotypes(acp.mat)$haps
acp.h<-hap.diversity(acp.hap.labs)
acp.h
